task dcUp(type: Exec) {
  group "docker-compose"
  executable "docker-compose"
  args "up", "-d"
  dependsOn 'installFrontendDependences'
}

task dcDown(type: Exec) {
  group "docker-compose"
  executable "docker-compose"
  args "down", "-v"
}

task dcRestartApi(type: Exec) {
  group "docker-compose"
  executable "docker-compose"
  args "up", "--detach", "--build", "api"
  dependsOn 'messenger:dockerBuild'
}

task dcRestartUserManager(type: Exec) {
  group "docker-compose"
  executable "docker-compose"
  args "up", "--detach", "--build", "api"
  dependsOn 'user-manager:dockerBuild'
}

task rebuildMessenger {
  group "application"
  dependsOn dcRestartApi
  doFirst {
    print project('messenger').tasks.dockerBuild
  }
}

task rebuildUserManager() {
  group "application"
  dependsOn 'dcRestartUserManager'
}

task installFrontendDependences(type: Exec) {
  group "frontend"
  executable "docker-compose"
  args "run", "frontend", "bash", "-c", "npm i"
}
